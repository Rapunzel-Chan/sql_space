<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.19.xsd">

    <changeSet id="1.1" author="space-sql">
        <!-- Сначала вставляем уроки -->
        <insert tableName="lesson">
            <column name="title" value="Базовый SELECT"/>
            <column name="description" value="Научитесь извлекать данные из таблиц"/>
            <column name="topic" value="Основы SELECT"/>
            <column name="difficulty" value="Легкий"/>
        </insert>

        <insert tableName="lesson">
            <column name="title" value="Основы JOIN"/>
            <column name="description" value="Освойте соединение таблиц"/>
            <column name="topic" value="JOIN и отношения"/>
            <column name="difficulty" value="Средний"/>
        </insert>

        <!-- Затем задачи, ссылающиеся на уроки -->
        <insert tableName="task">
            <column name="lesson_id" value="1"/>
            <column name="title" value="Выбор всех данных"/>
            <column name="description" value="Выберите все записи из таблицы users"/>
            <column name="schema_definition" value="CREATE TABLE users(id INT, name VARCHAR(100), age INT);"/>
            <column name="solution_query" value="SELECT * FROM users;"/>
        </insert>

        <insert tableName="task">
            <column name="lesson_id" value="1"/>
            <column name="title" value="Выбор с условием"/>
            <column name="description" value="Выберите пользователей старше 25 лет"/>
            <column name="schema_definition" value="CREATE TABLE users(id INT, name VARCHAR(100), age INT);"/>
            <column name="solution_query" value="SELECT * FROM users WHERE age > 25;"/>
        </insert>

        <insert tableName="task">
            <column name="lesson_id" value="2"/>
            <column name="title" value="Простой JOIN"/>
            <column name="description" value="Соедините таблицы users и orders"/>
            <column name="schema_definition" value="CREATE TABLE users(id INT, name VARCHAR(100)); CREATE TABLE orders(id INT, user_id INT, total DECIMAL(10,2));"/>
            <column name="solution_query" value="SELECT u.name, o.total FROM users u JOIN orders o ON u.id = o.user_id;"/>
        </insert>
    </changeSet>
</databaseChangeLog>